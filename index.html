<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>TG</title>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(to bottom, #0a0f29, #1a1f3c); /* 夜间背景 */
      color: #eee;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .wrap {
      width: 100%;
      max-width: 980px;
      padding: 32px 20px;
    }

    .panel {
      border: 1px solid #2b2b3a;
      border-radius: 16px;
      background: rgba(20,20,30,0.75);
      backdrop-filter: blur(6px);
      padding: 24px 28px;
      position: relative;
      z-index: 10;
      color: #eee;
    }

    h1 {
      margin: 0 0 4px;
      font-size: 20px;
      font-weight: 500;
      text-align: center;
      letter-spacing: 0.08em;
    }

    .sub {
      text-align: center;
      font-size: 12px;
      color: #bbb;
      margin-bottom: 16px;
    }

    .login,
    .albums,
    .gallery { display: none; }

    .login.active,
    .albums.active,
    .gallery.active { display: block; }

    .field {
      margin: 16px 0 8px;
    }

    label {
      font-size: 13px;
      display: block;
      margin-bottom: 6px;
    }

    input[type="password"] {
      width: 100%;
      padding: 9px 10px;
      border-radius: 10px;
      border: 1px solid #555;
      background: #1d1d28;
      color: #eee;
      font-size: 14px;
      outline: none;
    }

    input[type="password"]:focus {
      border-color: #fff;
    }

    button {
      margin-top: 10px;
      padding: 9px 14px;
      border-radius: 999px;
      border: 1px solid #eee;
      background: #eee;
      color: #111;
      font-size: 14px;
      cursor: pointer;
    }

    button:hover {
      background: #111;
      color: #eee;
    }

    .btn-block {
      width: 100%;
    }

    .hint {
      margin-top: 8px;
      font-size: 11px;
      color: #aaa;
      text-align: center;
    }

    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: #ccc;
      margin-bottom: 10px;
      gap: 8px;
    }

    .link-like {
      cursor: pointer;
      text-decoration: underline;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .img-box {
      position: relative;
      padding-top: 150%;
      background-size: cover;
      background-position: center;
      background-color: #222;
      border-radius: 8px;
      overflow: hidden;
    }

    .img-box::after {
      content: "";
      position: absolute;
      inset: 0;
      background: transparent;
      pointer-events: auto;
    }

    .album-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
      margin-top: 8px;
    }

    .album-card {
      border: 1px solid #333;
      border-radius: 12px;
      padding: 14px 16px;
      background: rgba(30,30,45,0.6);
      color: #eee;
    }

    .album-title {
      font-size: 15px;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .album-meta {
      font-size: 11px;
      color: #999;
      margin-bottom: 8px;
    }

    .album-desc {
      font-size: 12px;
      color: #ccc;
      margin-bottom: 10px;
    }

    .album-actions {
      display: flex;
      justify-content: flex-end;
    }

    .album-btn {
      margin-top: 0;
      font-size: 13px;
      padding-inline: 14px;
    }

    /* ========== 四周弹出的黑色小弹窗 ========== */
    .msg-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 5;
    }

    .msg-box-pop {
      position: absolute;
      min-width: 210px;
      max-width: 300px;
      background: rgba(0,0,0,0.65);
      color: #f5f5f5;
      font-size: 12px;
      padding: 8px 10px;
      border-radius: 8px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.45);
      line-height: 1.4;
      opacity: 0;
      transform: scale(0.9) translateY(4px);
      animation: fadePop 2.4s ease-out forwards;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.12);
      backdrop-filter: blur(6px);
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    @keyframes fadePop {
      0%   { opacity: 0; transform: scale(0.9) translateY(4px); }
      10%  { opacity: 1; transform: scale(1) translateY(0); }
      80%  { opacity: 1; transform: scale(1) translateY(0); }
      100% { opacity: 0; transform: scale(0.95) translateY(-4px); }
    }

    /* === 夜间冷光雪花 === */
    .snowflake {
      position: fixed;
      top: -10px;
      background: rgba(200, 220, 255, 0.95);
      box-shadow: 0 0 6px rgba(160, 200, 255, 0.9);
      border-radius: 50%;
      pointer-events: none;
      animation-name: snowFallNight;
      animation-timing-function: linear;
      z-index: 3;
    }

    @keyframes snowFallNight {
      0% {
        transform: translateY(0) translateX(0) rotate(0deg);
      }
      100% {
        transform: translateY(100vh) translateX(20px) rotate(360deg);
      }
    }
  </style>
</head>

<body oncontextmenu="return false;">

  <div class="msg-layer" id="msgLayer"></div>

  <div class="wrap">
    <div class="panel">
      <!-- 登录区域 -->
      <div class="login active" id="login">
        <h1>THK FOR WATCHING</h1>
        <div class="sub">Password required</div>

        <div class="field">
          <label for="pw">PASSWORD</label>
          <input type="password" id="pw" autocomplete="off" />
        </div>
        <button id="loginBtn" class="btn-block">ENTER</button>
        <p class="hint">仅供同好查看。</p >
      </div>

      <!-- 档案列表 -->
      <div class="albums" id="albums">
        <div class="topbar">
          <span>LIST</span>
          <span class="link-like" id="logoutTop">Log out</span>
        </div>
        <p class="hint">别的本子存档我也会放在这。</p >

        <div class="album-list">
          <div class="album-card">
            <div class="album-title">カノープスの光</div>
            <div class="album-meta">49p · 灶门炭治郎 x 富冈义勇</div>
            <div class="album-desc">点击进入后为整本 49 页浏览模式，请勿外传~</div>
            <div class="album-actions">
              <button class="album-btn" onclick="openカノープスの光()">OPEN</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 图片区域 -->
      <div class="gallery" id="gallery">
        <div class="topbar">
          <span>カノープスの光 · 49 pages</span>
          <span>
            <span class="link-like" onclick="backToAlbums()">← Back</span>
            &nbsp;&nbsp;
            <span class="link-like" id="logout">Log out</span>
          </span>
        </div>
        <p class="hint">请勿转载到其他平台，仅供阅读，能力范围内请支持原作者，购买实体~</p >

        <div class="grid">
          <!--（保持你原来的图片列表）-->
          <div class="img-box" style="background-image:url('images/0.jpg');"></div>
          <div class="img-box" style="background-image:url('images/1.jpg');"></div>
          <div class="img-box" style="background-image:url('images/2.jpg');"></div>
          <div class="img-box" style="background-image:url('images/3.jpg');"></div>
          <div class="img-box" style="background-image:url('images/4.jpg');"></div>
          <div class="img-box" style="background-image:url('images/5.jpg');"></div>
          <div class="img-box" style="background-image:url('images/6.jpg');"></div>
          <div class="img-box" style="background-image:url('images/7.jpg');"></div>
          <div class="img-box" style="background-image:url('images/8.jpg');"></div>
          <div class="img-box" style="background-image:url('images/9.jpg');"></div>
          <div class="img-box" style="background-image:url('images/10.jpg');"></div>
          <div class="img-box" style="background-image:url('images/11.jpg');"></div>
          <div class="img-box" style="background-image:url('images/12.jpg');"></div>
          <div class="img-box" style="background-image:url('images/13.jpg');"></div>
          <div class="img-box" style="background-image:url('images/14.jpg');"></div>
          <div class="img-box" style="background-image:url('images/15.jpg');"></div>
          <div class="img-box" style="background-image:url('images/16.jpg');"></div>
          <div class="img-box" style="background-image:url('images/17.jpg');"></div>
          <div class="img-box" style="background-image:url('images/18.jpg');"></div>
          <div class="img-box" style="background-image:url('images/19.jpg');"></div>
          <div class="img-box" style="background-image:url('images/20.jpg');"></div>
          <div class="img-box" style="background-image:url('images/21.jpg');"></div>
          <div class="img-box" style="background-image:url('images/22.jpg');"></div>
          <div class="img-box" style="background-image:url('images/23.jpg');"></div>
          <div class="img-box" style="background-image:url('images/24.jpg');"></div>
          <div class="img-box" style="background-image:url('images/25.jpg');"></div>
          <div class="img-box" style="background-image:url('images/26.jpg');"></div>
          <div class="img-box" style="background-image:url('images/27.jpg');"></div>
          <div class="img-box" style="background-image:url('images/28.jpg');"></div>
          <div class="img-box" style="background-image:url('images/29.jpg');"></div>
          <div class="img-box" style="background-image:url('images/30.jpg');"></div>
          <div class="img-box" style="background-image:url('images/31.jpg');"></div>
          <div class="img-box" style="background-image:url('images/32.jpg');"></div>
          <div class="img-box" style="background-image:url('images/33.jpg');"></div>
          <div class="img-box" style="background-image:url('images/34.jpg');"></div>
          <div class="img-box" style="background-image:url('images/35.jpg');"></div>
          <div class="img-box" style="background-image:url('images/36.jpg');"></div>
          <div class="img-box" style="background-image:url('images/37.jpg');"></div>
          <div class="img-box" style="background-image:url('images/38.jpg');"></div>
          <div class="img-box" style="background-image:url('images/39.jpg');"></div>
          <div class="img-box" style="background-image:url('images/40.jpg');"></div>
          <div class="img-box" style="background-image:url('images/41.jpg');"></div>
          <div class="img-box" style="background-image:url('images/43.jpg');"></div>
          <div class="img-box" style="background-image:url('images/44.jpg');"></div>
          <div class="img-box" style="background-image:url('images/45.jpg');"></div>
          <div class="img-box" style="background-image:url('images/46.jpg');"></div>
          <div class="img-box" style="background-image:url('images/47.jpg');"></div>
          <div class="img-box" style="background-image:url('images/48.jpg');"></div>
          <div class="img-box" style="background-image:url('images/49.jpg');"></div>

        </div>
      </div>
    </div>
  </div>

  <script>
    const PASSWORD = "071402081651761560925039";
    const HIKARI_PASSWORD = "merdeka772";

    const login     = document.getElementById("login");
    const albums    = document.getElementById("albums");
    const gallery   = document.getElementById("gallery");
    const pwInput   = document.getElementById("pw");
    const loginBtn  = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logout");
    const logoutTop = document.getElementById("logoutTop");

    function doLogin() {
      if (pwInput.value === PASSWORD) {
        login.classList.remove("active");
        albums.classList.add("active");
        pwInput.value = "";
      } else {
        alert("密码不正确");
      }
    }

    function openカノープスの光() {
      const second = prompt("请输入该本密码：");
      if (second === null) return;

      if (second === HIKARI_PASSWORD) {
        albums.classList.remove("active");
        gallery.classList.add("active");
      } else {
        alert("密码不正确");
      }
    }

    function backToAlbums() {
      gallery.classList.remove("active");
      albums.classList.add("active");
    }

    function doLogout() {
      gallery.classList.remove("active");
      albums.classList.remove("active");
      login.classList.add("active");
    }

    loginBtn.addEventListener("click", doLogin);
    pwInput.addEventListener("keydown", e => {
      if (e.key === "Enter") doLogin();
    });

    logoutBtn.addEventListener("click", doLogout);
    logoutTop.addEventListener("click", doLogout);

    document.addEventListener("keydown", e => {
      if (
        (e.ctrlKey && (e.key === "s" || e.key === "S" || e.key === "u" || e.key === "U")) ||
        e.key === "F12"
      ) {
        e.preventDefault();
      }
    });

    const msgLayer = document.getElementById("msgLayer");

    const messages = [
      "不要让他人把握生杀予夺的权力！",
      "不要哭，不要绝望。这不是你现在该做的事。",
      "义勇先生。",
      "要杀炭治郎，先从我的尸体上跨过去！",
      "义勇先生。",
      "义勇先生。",
      "炭治郎，你变得擅长战斗了。",
      "义勇先生不打算把锖兔托付给你的东西延续下去吗"
    ];

    let panelRect = null;

    function updatePanelRect() {
      const panel = document.querySelector(".panel");
      if (panel) {
        panelRect = panel.getBoundingClientRect();
      }
    }

    function randomPositionAroundPanel() {
      const vw = window.innerWidth;
      const vh = window.innerHeight;
      const boxWidth  = 260;
      const boxHeight = 70;

      if (!panelRect) updatePanelRect();

      const safeMargin = 40;
      const safeRect = panelRect
        ? {
            left:   panelRect.left   - safeMargin,
            right:  panelRect.right  + safeMargin,
            top:    panelRect.top    - safeMargin,
            bottom: panelRect.bottom + safeMargin
          }
        : null;

      let x = 0, y = 0;
      let tries = 0;

      while (tries < 50) {
        x = Math.random() * (vw - boxWidth);
        y = Math.random() * (vh - boxHeight);

        if (!safeRect) break;

        const boxRect = {
          left:   x,
          right:  x + boxWidth,
          top:    y,
          bottom: y + boxHeight
        };

        const overlap =
          boxRect.right  > safeRect.left  &&
          boxRect.left   < safeRect.right &&
          boxRect.bottom > safeRect.top   &&
          boxRect.top    < safeRect.bottom;

        if (!overlap) break;
        tries++;
      }

      return { x, y };
    }

    function spawnMsgBox() {
      if (!msgLayer || messages.length === 0) return;

      const msg = document.createElement("div");
      msg.className = "msg-box-pop";

      const content = messages[Math.floor(Math.random() * messages.length)];
      msg.textContent = content;

      const pos = randomPositionAroundPanel();
      msg.style.left = pos.x + "px";
      msg.style.top  = pos.y + "px";

      msgLayer.appendChild(msg);

      setTimeout(() => {
        msg.remove();
      }, 2400);
    }

    updatePanelRect();
    window.addEventListener("resize", updatePanelRect);
    setInterval(spawnMsgBox, 250);

    /* ========= 夜间飘雪效果 ========== */
    function createSnow() {
      const snow = document.createElement("div");
      snow.classList.add("snowflake");

      const size = Math.random() * 4 + 4;
      snow.style.width = size + "px";
      snow.style.height = size + "px";

      snow.style.left = Math.random() * window.innerWidth + "px";

      snow.style.animationDuration = (Math.random() * 4 + 5) + "s";

      document.body.appendChild(snow);

      setTimeout(() => snow.remove(), 9000);
    }

    setInterval(createSnow, 180);
  </script>

</body>
</html>
